<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.catchtable.clone.infrastructure.shop.ShopRepository">
    <insert id="shopStore" parameterType="com.catchtable.clone.domain.shop.Shop"
            useGeneratedKeys="true" keyProperty="id">
        INSERT INTO tbl_shop (shop_token, shop_id, shop_pw, category, name, introduction, created_at)
        VALUES (#{shopToken}, #{shopId}, #{shopPw}, #{category}, #{shopName}, #{shopIntroduction}, #{createdAt});
    </insert>
    <insert id="shopInformationStore" parameterType="com.catchtable.clone.domain.shop.ShopInformation"
            useGeneratedKeys="true" keyProperty="id">
        INSERT INTO tbl_shop_information (shop_token, phone, info_introduction, opening, holiday, instruction, homepage)
        VALUES (#{shopToken}, #{phone}, #{infoIntroduction}, #{opening}, #{holiday}, #{instruction}, #{homepage});
    </insert>

    <resultMap id="shopResultMap" type="com.catchtable.clone.domain.shop.Shop">
        <result column="shop_token" property="shopToken"/>
        <result column="shop_id" property="shopId"/>
        <result column="shop_pw" property="shopPw"/>
        <result column="name" property="shopName"/>
        <result column="introduction" property="shopIntroduction"/>
        <result column="created_at" property="createdAt"/>
    </resultMap>

    <select id="login" parameterType="com.catchtable.clone.domain.shop.Shop"
            resultType="com.catchtable.clone.domain.shop.Shop"
            resultMap="shopResultMap">
        SELECT * FROM tbl_shop WHERE shop_id = #{shopId} AND shop_pw = #{shopPw}
    </select>
</mapper>